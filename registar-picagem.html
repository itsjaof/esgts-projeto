<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PointSystem | Registar Picagem</title>

    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/common.css">
    <link rel="stylesheet" href="./css/registar-picagem-page.css">

    <script src="https://kit.fontawesome.com/8a3dad9eb0.js" crossorigin="anonymous"></script>
</head>
<body>
    <div class="sidebar">
        <div class="logo">
            <i class="fas fa-clock"></i> PointSystem
        </div>
    
        <nav>
            <a class="nav-item" href="dashboard.html">
                <i class="fas fa-home"></i> Dashboard
            </a>
            <a class="nav-item active">
                <i class="fas fa-fingerprint"></i> Registar Picagem
            </a>
            <a class="nav-item" href="empregados.html">
                <i class="fas fa-users"></i> Empregados
            </a>
            <a class="nav-item" href="picagens.html">
                <i class="fas fa-list-alt"></i> Picagens
            </a>
        </nav>
    
        <div class="bottom-menu">
            <a class="nav-item" id="theme-toggle">
                <i class="fas fa-palette"></i> <span class="theme-text">Tema</span>
            </a>
            <a class="nav-item">
                <i class="fas fa-sign-out-alt"></i> Sair
            </a>
        </div>
    </div>

    <div class="main-content">
        <div class="content-header">
            <h1>Registar Picagem</h1>
            <p class="subtitle">Aqui poderá registar a sua entrada ou saída.</p>
        </div>

        <div class="picagem-container">
            <div class="time-display-card">
                <div class="date-display" id="date-display">Sexta-Feira, 3 de Outubro de 2025</div>
                <div class="time-display" id="time-display">12:12:12</div>
                <div class="location-display">
                    <i class="fas fa-map-marker-alt"></i> <span id="location-text">Localização desconhecida.</span>
                </div>
            </div>

            <div class="status-hours-card">
                <div class="status-section">
                    <div class="status-label">Estado Atual</div>
                    <div class="status-value" id="current-status">Estado</div>
                </div>
                <div class="hours-section">
                    <div class="hours-label">Horas Hoje</div>
                    <div class="hours-value" id="hours-today">0h 00m</div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="punch-btn punch-btn-entry" id="entry-btn">
                    <i class="fas fa-sign-in-alt"></i>
                    <span>Registar Entrada</span>
                </button>
                <button class="punch-btn punch-btn-pause" id="pause-btn">
                    <i class="fas fa-pause"></i>
                    <span>Registar Pausa</span>
                </button>
                <button class="punch-btn punch-btn-exit" id="exit-btn">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Registar Saída</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Sistema de Tema
        const themeToggle = document.getElementById('theme-toggle');
        const themeText = themeToggle.querySelector('.theme-text');
        const html = document.documentElement;

        // Verificar tema salvo ou preferência do sistema
        function getInitialTheme() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                return savedTheme;
            }
            // Verificar preferência do sistema
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                return 'dark';
            }
            return 'light';
        }

        // Aplicar tema
        function setTheme(theme) {
            html.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            updateThemeIcon(theme);
        }

        // Atualizar ícone do tema
        function updateThemeIcon(theme) {
            const icon = themeToggle.querySelector('i');
            if (theme === 'dark') {
                icon.className = 'fas fa-sun';
                themeText.textContent = 'Tema Claro';
            } else {
                icon.className = 'fas fa-moon';
                themeText.textContent = 'Tema Escuro';
            }
        }

        // Inicializar tema
        const currentTheme = getInitialTheme();
        setTheme(currentTheme);

        // Alternar tema ao clicar
        themeToggle.addEventListener('click', (e) => {
            e.preventDefault();
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            setTheme(newTheme);
        });

        // Ouvir mudanças na preferência do sistema (opcional)
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
            if (!localStorage.getItem('theme')) {
                setTheme(e.matches ? 'dark' : 'light');
            }
        });

        // Relógio em tempo real
        function updateClock() {
            const now = new Date();
            
            // Formatar hora
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            document.getElementById('time-display').textContent = `${hours}:${minutes}:${seconds}`;
            
            // Formatar data
            const days = ['Domingo', 'Segunda-Feira', 'Terça-Feira', 'Quarta-Feira', 'Quinta-Feira', 'Sexta-Feira', 'Sábado'];
            const months = ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
            const dayName = days[now.getDay()];
            const day = now.getDate();
            const month = months[now.getMonth()];
            const year = now.getFullYear();
            document.getElementById('date-display').textContent = `${dayName}, ${day} de ${month} de ${year}`;
        }

        // Atualizar relógio a cada segundo
        updateClock();
        setInterval(updateClock, 1000);

        // Obter localização (se permitido)
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    const lat = position.coords.latitude.toFixed(6);
                    const lng = position.coords.longitude.toFixed(6);
                    document.getElementById('location-text').textContent = `${lat}, ${lng}`;
                },
                () => {
                    document.getElementById('location-text').textContent = 'Localização desconhecida.';
                }
            );
        }

        // Botões de ação
        const entryBtn = document.getElementById('entry-btn');
        const pauseBtn = document.getElementById('pause-btn');
        const exitBtn = document.getElementById('exit-btn');
        const currentStatusEl = document.getElementById('current-status');

        let currentState = 'none'; // none, working, paused

        entryBtn.addEventListener('click', () => {
            currentState = 'working';
            currentStatusEl.textContent = 'Em Trabalho';
            currentStatusEl.className = 'status-value status-working';
        });

        pauseBtn.addEventListener('click', () => {
            if (currentState === 'working') {
                currentState = 'paused';
                currentStatusEl.textContent = 'Em Pausa';
                currentStatusEl.className = 'status-value status-paused';
            }
        });

        exitBtn.addEventListener('click', () => {
            if (currentState === 'working' || currentState === 'paused') {
                currentState = 'none';
                currentStatusEl.textContent = 'Fora de Serviço';
                currentStatusEl.className = 'status-value status-none';
            }
        });
    </script>
</body>
</html>


